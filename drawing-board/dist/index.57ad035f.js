class DrawingBoard{MODE="NONE";IsMouseDown=!1;eraserColor="#FFF";backgroundColor="#FFF";IsNavigatorVisible=!1;undoArray=[];containerEl;canvasEl;toolbarEl;brushEl;colorPickerEl;brushPanelEl;brushSliderEl;brushSizePreviewEl;eraserEl;navigatorEl;navigatorImageContainerEl;navigatorImageEl;undoEl;clearEl;downloadEl;constructor(){this.assignElement(),this.initContext(),this.initCanvasBackgroundColor(),this.addEvent()}assignElement(){this.containerEl=document.getElementById("container"),this.canvasEl=this.containerEl.querySelector("#canvas"),this.toolbarEl=this.containerEl.querySelector("#toolbar"),this.brushEl=this.toolbarEl.querySelector("#brush"),this.colorPickerEl=this.toolbarEl.querySelector("#colorPicker"),this.brushPanelEl=this.containerEl.querySelector("#brushPanel"),this.brushSliderEl=this.brushPanelEl.querySelector("#brushSize"),this.brushSizePreviewEl=this.brushPanelEl.querySelector("#brushSizePreview"),this.eraserEl=this.toolbarEl.querySelector("#eraser"),this.navigatorEl=this.toolbarEl.querySelector("#navigator"),this.navigatorImageContainerEl=this.containerEl.querySelector("#imgNav"),this.navigatorImageEl=this.navigatorImageContainerEl.querySelector("#canvasImg"),this.undoEl=this.toolbarEl.querySelector("#undo"),this.clearEl=this.toolbarEl.querySelector("#clear"),this.downloadEl=this.toolbarEl.querySelector("#download")}initContext(){this.context=this.canvasEl.getContext("2d")}initCanvasBackgroundColor(){this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,this.canvasEl.width,this.canvasEl.height)}addEvent(){this.brushEl.addEventListener("click",this.onClickBrush),this.canvasEl.addEventListener("mousedown",this.onMouseDown),this.canvasEl.addEventListener("mousemove",this.onMouseMove),this.canvasEl.addEventListener("mouseup",this.onMouseUp),this.canvasEl.addEventListener("mouseout",this.onMouseOut),this.brushSliderEl.addEventListener("input",this.onChangeBrushSize),this.colorPickerEl.addEventListener("input",this.onChangeColor),this.eraserEl.addEventListener("click",this.onClickEraser),this.navigatorEl.addEventListener("click",this.onClickNavigator),this.undoEl.addEventListener("click",this.onClickUndo),this.clearEl.addEventListener("click",this.onClickClear),this.downloadEl.addEventListener("click",this.onClickDownload)}onChangeColor=t=>{this.brushSizePreviewEl.style.backgroundColor=t.target.value};onChangeBrushSize=t=>{this.brushSizePreviewEl.style.width=`${t.target.value}px`,this.brushSizePreviewEl.style.height=`${t.target.value}px`};onMouseDown=t=>{if("NONE"===this.MODE)return;this.isMouseDown=!0;const e=this.getMousePosition(t);this.context.beginPath(),this.context.moveTo(e.x,e.y),this.context.lineCap="round","BRUSH"===this.MODE?(this.context.strokeStyle=this.colorPickerEl.value,this.context.lineWidth=this.brushSliderEl.value):"ERASER"===this.MODE&&(this.context.strokeStyle=this.eraserColor,this.context.lineWidth=50),this.saveState()};onMouseMove=t=>{if(!this.isMouseDown)return;const e=this.getMousePosition(t);this.context.lineTo(e.x,e.y),this.context.stroke()};onMouseUp=()=>{"NONE"!==this.MODE&&(this.isMouseDown=!1,this.updateNavigator())};onMouseOut=()=>{"NONE"!==this.MODE&&(this.isMouseDown=!1,this.updateNavigator())};getMousePosition=t=>{const e=this.canvasEl.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};onClickBrush=t=>{const e=t.currentTarget.classList.contains("active");this.MODE=e?"NONE":"BRUSH",this.canvasEl.style.cursor=e?"default":"crosshair",this.brushPanelEl.classList.toggle("hide"),t.currentTarget.classList.toggle("active"),this.eraserEl.classList.remove("active")};onClickEraser=t=>{const e=t.currentTarget.classList.contains("active");this.MODE=e?"NONE":"ERASER",this.canvasEl.style.cursor=e?"default":"crosshair",this.brushPanelEl.classList.add("hide"),t.currentTarget.classList.toggle("active"),this.brushEl.classList.remove("active")};onClickNavigator=t=>{this.IsNavigatorVisible=!t.currentTarget.classList.cotains("active"),t.currentTarget.classList.toggle("active"),this.navigatorImageContainerEl.classList.toggle("hide"),this.updateNavigator()};updateNavigator=()=>{this.IsNavigatorVisible&&(this.navigatorImageEl.src=this.canvasEl.toDataURL())};saveState=()=>{if(this.undoArray.length>4)return this.undoArray.shift(),void this.undoArray.push(this.canvasEl.toDataURL());this.undoArray.push(this.canvasEl.toDataURL())};onClickUndo=()=>{if(0===this.undoArray.length)return;let t=this.undoArray.pop(),e=new Image;e.onload=()=>{this.context.clearRect(0,0,this.canvasEl.width,this.canvasEl.height),this.context.drawImage(e,0,0,this.canvasEl.width,this.canvasEl.height,0,0,this.canvasEl.width,this.canvasEl.height)},e.src=t};onClickClear=()=>{this.context.clearRect(0,0,this.canvasEl.width,this.canvasEl.height),this.undoArray=[],this.updateNavigator(),this.initCanvasBackgroundColor()};onClickDownload=()=>{this.downloadEl.href=this.canvasEl.toDataURL("image/jpeg",1),this.downloadEl.download="example.jpeg"}}new DrawingBoard;
//# sourceMappingURL=index.57ad035f.js.map
